---
title: "Speakers in the Congressional Recored"
subtitle: 
author: ""
output:
  html_document:
    highlight: zenburn
    toc: true
    toc_float: true
    code_folding: hide
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
source(here::here("code/setup.R"))
```




## Parsed text

.txt files are saved on the Linstat server which you can access on your own computer as a [network drive](https://kb.wisc.edu/sscc/95802) or via the [Winstat VPN](https://kb.wisc.edu/sscc/working-from-home-or-other-remote-locations).
```{r}
knitr::include_graphics(here("figs", "winstat.png"))
```


## Counts of total speeches 

Because the parsed .txt files are saved in subfolders by year/icpsr, counts per member per year are just the number of files in each folder (see [code/count_speeches.R](https://github.com/judgelord/cr/blob/master/code/count_speeches.R)) 

```{r, cache=TRUE}
# from code/count_speeches.R
load(here('data', 'd_count.Rdata'))

# from voteview 
load(here('data', 'members.Rdata'))

# join speech counts with voteview 
d <- d_count %>% left_join(members)

# name + district strings for display
d %<>% mutate(name_district = bioname %>% str_remove(",.*") %>% str_to_title() %>% paste(cqlabel)) %>% 
  mutate(district_name = cqlabel %>% str_c(bioname, sep = ": ") %>% str_remove_all(",.*|\\(|\\)"))
```


Most speeches per year: 
```{r}
d %>% 
  select(year, name_district, icpsr, n_speeches) %>% 
  arrange(-n_speeches) %>% kablebox()
```

---

The Wisconsin delegation
```{r wi, fig.height=11}
d %>% 
  filter(state_abbrev == "WI",!is.na(year)) %>% 
  ggplot() +
  aes(x = n_speeches, y = district_name, fill = nominate.dim1) + 
  geom_col() + 
  facet_wrap("year", scales = "free_y", ncol = 2) +
  labs(y = "", x  = "Total Number of Speeches") +
  scale_fill_gradient2(low = muted("blue"), high = muted("red"), mid = "grey80")
```